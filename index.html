<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropdown from Google Sheets</title>
    <style>
        body { font-family: Arial, sans-serif; }
        select, p { margin-top: 10px; }
    </style>
</head>
<body>

    <h2>Select a State and AHJ</h2>
    <label for="state">State:</label>
    <select id="state" onchange="updateAHJ()">
        <option value="">Select State</option>
    </select>

    <label for="ahj">AHJ:</label>
    <select id="ahj" onchange="displayNote()">
        <option value="">Select AHJ</option>
    </select>

    <p id="note"></p>

    <script>
        const sheetUrl = "https://script.google.com/macros/s/AKfycbybzOh2zN4xH1IxnLUVW6vt_1uV7axwb2XZ-dBAr0pbhJhtV7-H2v23SEcPBYm3chjg/exec"; // Replace with your deployed script URL

        let allData = [];

        async function fetchData() {
            const response = await fetch(sheetUrl);
            const data = await response.json();
            allData = data;

            const states = [...new Set(data.map(item => item.state))];
            const stateDropdown = document.getElementById("state");

            states.forEach(state => {
                let option = document.createElement("option");
                option.value = state;
                option.textContent = state;
                stateDropdown.appendChild(option);
            });
        }

        function updateAHJ() {
            const selectedState = document.getElementById("state").value;
            const ahjDropdown = document.getElementById("ahj");

            ahjDropdown.innerHTML = '<option value="">Select AHJ</option>';

            const filteredAHJs = allData.filter(item => item.state === selectedState);

            filteredAHJs.forEach(item => {
                let option = document.createElement("option");
                option.value = item.ahj;
                option.textContent = item.ahj;
                ahjDropdown.appendChild(option);
            });
        }

        function displayNote() {
            const selectedAHJ = document.getElementById("ahj").value;
            const noteParagraph = document.getElementById("note");

            const foundData = allData.find(item => item.ahj === selectedAHJ);
            noteParagraph.textContent = foundData ? foundData.note : "";
        }

        fetchData();
    </script>

</body>
</html>
